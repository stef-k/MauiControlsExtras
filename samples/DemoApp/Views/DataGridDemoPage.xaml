<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:DemoApp.ViewModels"
             xmlns:extras="clr-namespace:MauiControlsExtras.Controls;assembly=MauiControlsExtras"
             x:Class="DemoApp.Views.DataGridDemoPage"
             x:DataType="vm:DataGridDemoViewModel"
             Title="DataGridView">

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="20" RowSpacing="15">
        <!-- Title -->
        <VerticalStackLayout Grid.Row="0" Spacing="5">
            <Label Text="DataGridView Demo" Style="{StaticResource PageTitleStyle}" />
            <Label Text="A full-featured data grid with sorting, filtering, and editing."
                   Style="{StaticResource PageDescriptionStyle}" />
        </VerticalStackLayout>

        <!-- Toolbar -->
        <Frame Grid.Row="1" Style="{StaticResource DemoCardStyle}" Padding="15">
            <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto">
                <!-- Options -->
                <FlexLayout Grid.Row="0" Grid.Column="0" Wrap="Wrap" JustifyContent="Start" AlignItems="Center">
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserSort}" />
                        <Label Text="Sorting" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserFilter}" />
                        <Label Text="Filtering" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserEdit}" />
                        <Label Text="Editing" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding EnablePagination}" />
                        <Label Text="Pagination" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </FlexLayout>

                <!-- Action Buttons -->
                <HorizontalStackLayout Grid.Row="0" Grid.Column="1" Spacing="10">
                    <Button Text="Add" Command="{Binding AddEmployeeCommand}" Style="{StaticResource PrimaryButtonStyle}" />
                    <Button Text="Delete" Command="{Binding DeleteEmployeeCommand}" Style="{StaticResource SecondaryButtonStyle}" />
                    <Button Text="Refresh" Command="{Binding RefreshDataCommand}" Style="{StaticResource SecondaryButtonStyle}" />
                </HorizontalStackLayout>

                <!-- Row Count -->
                <Label Grid.Row="1" Grid.ColumnSpan="2"
                       Text="{Binding Employees.Count, StringFormat='Total: {0} employees'}"
                       TextColor="{StaticResource Gray400}"
                       Margin="0,10,0,0" />
            </Grid>
        </Frame>

        <!-- DataGrid -->
        <Frame Grid.Row="2" Style="{StaticResource DemoCardStyle}" Padding="0">
            <extras:DataGridView ItemsSource="{Binding Employees}"
                                 SelectedItem="{Binding SelectedEmployee}"
                                 CanUserSort="{Binding CanUserSort}"
                                 CanUserFilter="{Binding CanUserFilter}"
                                 CanUserEdit="{Binding CanUserEdit}"
                                 EnablePagination="{Binding EnablePagination}"
                                 SelectionChanged="OnSelectionChanged">
                <extras:DataGridView.Columns>
                    <extras:DataGridColumn Header="ID" PropertyName="Id" Width="60" IsReadOnly="True" />
                    <extras:DataGridColumn Header="Name" PropertyName="Name" Width="150" />
                    <extras:DataGridComboBoxColumn Header="Department" PropertyName="Department" Width="120" ItemsSource="{Binding Source={RelativeSource AncestorType={x:Type vm:DataGridDemoViewModel}}, Path=Departments}" />
                    <extras:DataGridColumn Header="Salary" PropertyName="Salary" Width="100" StringFormat="${0:N0}" />
                    <extras:DataGridColumn Header="Hire Date" PropertyName="HireDate" Width="100" StringFormat="{0:d}" />
                    <extras:DataGridColumn Header="Active" PropertyName="IsActive" Width="70" />
                    <extras:DataGridColumn Header="Email" PropertyName="Email" Width="200" />
                </extras:DataGridView.Columns>
            </extras:DataGridView>
        </Frame>

        <!-- Status -->
        <Label Grid.Row="3" Text="{Binding StatusMessage}" Style="{StaticResource StatusLabelStyle}" />
    </Grid>

</ContentPage>
