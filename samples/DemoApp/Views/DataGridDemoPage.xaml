<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:DemoApp.ViewModels"
             xmlns:extras="clr-namespace:MauiControlsExtras.Controls;assembly=MauiControlsExtras"
             x:Class="DemoApp.Views.DataGridDemoPage"
             x:DataType="vm:DataGridDemoViewModel"
             Title="DataGridView">

    <Grid RowDefinitions="Auto,Auto,*,Auto" Padding="20" RowSpacing="15">
        <!-- Title -->
        <VerticalStackLayout Grid.Row="0" Spacing="5">
            <Label Text="DataGridView Demo" Style="{StaticResource PageTitleStyle}" />
            <Label Text="A full-featured data grid with sorting, filtering, and editing."
                   Style="{StaticResource PageDescriptionStyle}" />
        </VerticalStackLayout>

        <!-- Toolbar -->
        <Frame Grid.Row="1" Style="{StaticResource DemoCardStyle}" Padding="15">
            <Grid RowDefinitions="Auto,Auto,Auto">
                <!-- Options -->
                <FlexLayout Grid.Row="0" Wrap="Wrap" JustifyContent="Start" AlignItems="Center">
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserSort}" />
                        <Label Text="Sorting" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserFilter}" />
                        <Label Text="Filtering" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding CanUserEdit}" />
                        <Label Text="Editing" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="5" Margin="0,0,20,5">
                        <CheckBox IsChecked="{Binding EnablePagination}" />
                        <Label Text="Pagination" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                </FlexLayout>

                <!-- Action Buttons -->
                <FlexLayout Grid.Row="1"
                            Direction="Row"
                            Wrap="Wrap"
                            JustifyContent="Start"
                            AlignItems="Center"
                            Margin="0,10,0,0">
                    <Button Text="Add"
                            Command="{Binding AddEmployeeCommand}"
                            Style="{StaticResource PrimaryButtonStyle}"
                            Margin="0,0,10,10"
                            Padding="{OnIdiom Phone='14,8', Tablet='20,12', Desktop='20,12'}"
                            HeightRequest="{OnIdiom Phone=40, Tablet=44, Desktop=-1}" />
                    <Button Text="Delete"
                            Command="{Binding DeleteEmployeeCommand}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Margin="0,0,10,10"
                            Padding="{OnIdiom Phone='14,8', Tablet='20,12', Desktop='20,12'}"
                            HeightRequest="{OnIdiom Phone=40, Tablet=44, Desktop=-1}" />
                    <Button Text="Refresh"
                            Command="{Binding RefreshDataCommand}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Margin="0,0,0,10"
                            Padding="{OnIdiom Phone='14,8', Tablet='20,12', Desktop='20,12'}"
                            HeightRequest="{OnIdiom Phone=40, Tablet=44, Desktop=-1}" />
                </FlexLayout>

                <!-- Row Count -->
                <Label Grid.Row="2"
                       Text="{Binding Employees.Count, StringFormat='Total: {0} employees'}"
                       TextColor="{StaticResource Gray400}"
                       Margin="0,10,0,0" />
            </Grid>
        </Frame>

        <!-- DataGrid -->
        <Frame Grid.Row="2" Style="{StaticResource DemoCardStyle}" Padding="0">
            <ScrollView Orientation="Horizontal">
                <Grid MinimumHeightRequest="300"
                      WidthRequest="{OnIdiom Phone=980, Tablet=1200, Desktop=-1}">
                    <extras:DataGridView x:Name="dataGrid"
                                         ItemsSource="{Binding Employees}"
                                         SelectedItem="{Binding SelectedEmployee}"
                                         CanUserSort="{Binding CanUserSort}"
                                         CanUserFilter="{Binding CanUserFilter}"
                                         CanUserEdit="{Binding CanUserEdit}"
                                         EnablePagination="{Binding EnablePagination}"
                                         ShowDefaultContextMenu="True"
                                         AutoGenerateColumns="False"
                                         VerticalOptions="FillAndExpand"
                                         HorizontalOptions="FillAndExpand"
                                         SelectionChanged="OnSelectionChanged" />
                </Grid>
            </ScrollView>
        </Frame>

        <!-- Status -->
        <Label Grid.Row="3" Text="{Binding StatusMessage}" Style="{StaticResource StatusLabelStyle}" />
    </Grid>

</ContentPage>
