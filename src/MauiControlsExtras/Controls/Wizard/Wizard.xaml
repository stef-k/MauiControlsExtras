<?xml version="1.0" encoding="utf-8" ?>
<base:HeaderedControlBase xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                          xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                          xmlns:base="clr-namespace:MauiControlsExtras.Base"
                          xmlns:local="clr-namespace:MauiControlsExtras.Controls"
                          x:Class="MauiControlsExtras.Controls.Wizard"
                          x:Name="thisControl">

    <Border StrokeThickness="{Binding EffectiveBorderThickness, Source={x:Reference thisControl}}"
            Stroke="{Binding EffectiveBorderColor, Source={x:Reference thisControl}}"
            BackgroundColor="{AppThemeBinding Light=#FFFFFF, Dark=#1E1E1E}">
        <Border.StrokeShape>
            <RoundRectangle CornerRadius="{Binding EffectiveCornerRadius, Source={x:Reference thisControl}}" />
        </Border.StrokeShape>

        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Step Indicator (Top) -->
            <Border Grid.Row="0"
                    x:Name="stepIndicatorTop"
                    BackgroundColor="{Binding EffectiveHeaderBackgroundColor, Source={x:Reference thisControl}}"
                    Padding="{Binding HeaderPadding, Source={x:Reference thisControl}}">
                <ScrollView Orientation="Horizontal"
                            HorizontalScrollBarVisibility="Never">
                    <HorizontalStackLayout x:Name="stepIndicatorContainer"
                                           Spacing="0"
                                           HorizontalOptions="Center" />
                </ScrollView>
            </Border>

            <!-- Content Area -->
            <Border Grid.Row="1"
                    Padding="16"
                    BackgroundColor="Transparent">
                <Grid>
                    <!-- Current step title and description -->
                    <Grid RowDefinitions="Auto,Auto,*">
                        <Label x:Name="stepTitleLabel"
                               Grid.Row="0"
                               FontSize="{Binding HeaderFontSize, Source={x:Reference thisControl}}"
                               FontAttributes="{Binding HeaderFontAttributes, Source={x:Reference thisControl}}"
                               TextColor="{Binding EffectiveForegroundColor, Source={x:Reference thisControl}}"
                               Margin="0,0,0,4" />

                        <Label x:Name="stepDescriptionLabel"
                               Grid.Row="1"
                               FontSize="13"
                               TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}"
                               Margin="0,0,0,16" />

                        <!-- Step Content -->
                        <ContentView x:Name="stepContentContainer"
                                     Grid.Row="2" />
                    </Grid>

                    <!-- Empty state -->
                    <Label x:Name="emptyLabel"
                           IsVisible="False"
                           Text="No steps defined"
                           HorizontalOptions="Center"
                           VerticalOptions="Center"
                           TextColor="{AppThemeBinding Light=#999999, Dark=#666666}" />
                </Grid>
            </Border>

            <!-- Navigation Buttons -->
            <Border Grid.Row="2"
                    BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#2D2D2D}"
                    Padding="12,8">
                <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                    <!-- Cancel Button -->
                    <Button x:Name="cancelButton"
                            Grid.Column="0"
                            Text="{Binding CancelButtonText, Source={x:Reference thisControl}}"
                            IsVisible="{Binding ShowCancelButton, Source={x:Reference thisControl}}"
                            Clicked="OnCancelClicked"
                            BackgroundColor="Transparent"
                            TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}" />

                    <!-- Spacer -->
                    <BoxView Grid.Column="1" />

                    <!-- Skip Button -->
                    <Button x:Name="skipButton"
                            Grid.Column="2"
                            Text="{Binding SkipButtonText, Source={x:Reference thisControl}}"
                            IsVisible="False"
                            Clicked="OnSkipClicked"
                            BackgroundColor="Transparent"
                            TextColor="{AppThemeBinding Light=#666666, Dark=#AAAAAA}"
                            Margin="0,0,8,0" />

                    <!-- Back Button -->
                    <Button x:Name="backButton"
                            Grid.Column="3"
                            Text="{Binding BackButtonText, Source={x:Reference thisControl}}"
                            IsVisible="{Binding ShowBackButton, Source={x:Reference thisControl}}"
                            Clicked="OnBackClicked"
                            BackgroundColor="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"
                            TextColor="{Binding EffectiveForegroundColor, Source={x:Reference thisControl}}"
                            Margin="0,0,8,0" />

                    <!-- Next/Finish Button -->
                    <Button x:Name="nextButton"
                            Grid.Column="4"
                            Text="{Binding NextButtonText, Source={x:Reference thisControl}}"
                            Clicked="OnNextClicked"
                            BackgroundColor="{Binding EffectiveAccentColor, Source={x:Reference thisControl}}"
                            TextColor="White" />
                </Grid>
            </Border>
        </Grid>
    </Border>
</base:HeaderedControlBase>
